<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Essential Lookup Tools - Usage Examples • hgnc.mcp</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Essential Lookup Tools - Usage Examples"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">hgnc.mcp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/normalizing-gene-lists.html">Normalizing Gene Lists</a></li>
    <li><a class="dropdown-item" href="articles/gene-groups.html">Working with Gene Groups</a></li>
    <li><a class="dropdown-item" href="articles/running-mcp-server.html">Running the MCP Server</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/armish/hgnc.mcp" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/armish/hgnc.mcp/pkgs/container/hgnc.mcp" aria-label="Docker Hub"><span class="fa fa-docker"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Essential Lookup Tools - Usage Examples</h1>
      <small class="dont-index">Source: <a href="https://github.com/armish/hgnc.mcp/blob/main/EXAMPLES.md" class="external-link"><code>EXAMPLES.md</code></a></small>
    </div>

<div id="essential-lookup-tools---usage-examples" class="section level1">

<p>This document demonstrates the core HGNC lookup tools implemented in Phase 1.2.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p>Six essential lookup and batch processing functions have been implemented:</p>
<div class="section level3">
<h3 id="core-lookup-functions-phase-12">Core Lookup Functions (Phase 1.2)<a class="anchor" aria-label="anchor" href="#core-lookup-functions-phase-12"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong><code><a href="reference/hgnc_find.html">hgnc_find()</a></code></strong> - Search for genes across multiple fields</li>
<li>
<strong><code><a href="reference/hgnc_fetch.html">hgnc_fetch()</a></code></strong> - Retrieve complete gene records by field value</li>
<li>
<strong><code><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol()</a></code></strong> - Resolve gene symbols to approved symbols</li>
<li>
<strong><code><a href="reference/hgnc_xrefs.html">hgnc_xrefs()</a></code></strong> - Extract cross-references from gene records</li>
</ol></div>
<div class="section level3">
<h3 id="batch-operations-phase-13">Batch Operations (Phase 1.3)<a class="anchor" aria-label="anchor" href="#batch-operations-phase-13"></a></h3>
<ol start="5" style="list-style-type: decimal"><li>
<strong><code><a href="reference/build_symbol_index.html">build_symbol_index()</a></code></strong> - Create fast lookup index from cached data</li>
<li>
<strong><code><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list()</a></code></strong> - Batch normalize gene symbol lists using cached data</li>
</ol></div>
</div>
<div class="section level2">
<h2 id="installation--setup">Installation &amp; Setup<a class="anchor" aria-label="anchor" href="#installation--setup"></a></h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install dependencies if needed</span></span>
<span><span class="co"># install.packages(c("httr", "jsonlite", "memoise", "rappdirs", "readr", "lubridate"))</span></span>
<span></span>
<span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://armish.github.io/hgnc.mcp/">hgnc.mcp</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-examples">Function Examples<a class="anchor" aria-label="anchor" href="#function-examples"></a></h2>
<div class="section level3">
<h3 id="id_1-search-for-genes-hgnc_find">1. Search for Genes: <code>hgnc_find()</code>
<a class="anchor" aria-label="anchor" href="#id_1-search-for-genes-hgnc_find"></a></h3>
<p>Search across gene symbols, aliases, previous symbols, and names:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simple search</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_find.html">hgnc_find</a></span><span class="op">(</span><span class="st">"BRCA1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">numFound</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">docs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">symbol</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Search with filters</span></span>
<span><span class="va">kinase_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_find.html">hgnc_find</a></span><span class="op">(</span><span class="st">"kinase"</span>,</span>
<span>  filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    status <span class="op">=</span> <span class="st">"Approved"</span>,</span>
<span>    locus_type <span class="op">=</span> <span class="st">"gene with protein product"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Explore results</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">doc</span> <span class="kw">in</span> <span class="va">kinase_genes</span><span class="op">$</span><span class="va">docs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s - %s\n"</span>, <span class="va">doc</span><span class="op">$</span><span class="va">symbol</span>, <span class="va">doc</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-fetch-gene-records-hgnc_fetch">2. Fetch Gene Records: <code>hgnc_fetch()</code>
<a class="anchor" aria-label="anchor" href="#id_2-fetch-gene-records-hgnc_fetch"></a></h3>
<p>Retrieve complete gene information using various identifiers:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch by official symbol</span></span>
<span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_fetch.html">hgnc_fetch</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"BRCA1"</span><span class="op">)</span></span>
<span><span class="va">record</span> <span class="op">&lt;-</span> <span class="va">gene</span><span class="op">$</span><span class="va">docs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Symbol:"</span>, <span class="va">record</span><span class="op">$</span><span class="va">symbol</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Name:"</span>, <span class="va">record</span><span class="op">$</span><span class="va">name</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Location:"</span>, <span class="va">record</span><span class="op">$</span><span class="va">location</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Status:"</span>, <span class="va">record</span><span class="op">$</span><span class="va">status</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch by HGNC ID</span></span>
<span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_fetch.html">hgnc_fetch</a></span><span class="op">(</span><span class="st">"hgnc_id"</span>, <span class="st">"HGNC:1100"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch by Entrez ID</span></span>
<span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_fetch.html">hgnc_fetch</a></span><span class="op">(</span><span class="st">"entrez_id"</span>, <span class="st">"672"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch by Ensembl ID</span></span>
<span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_fetch.html">hgnc_fetch</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"ENSG00000012048"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-resolve-gene-symbols-hgnc_resolve_symbol">3. Resolve Gene Symbols: <code>hgnc_resolve_symbol()</code>
<a class="anchor" aria-label="anchor" href="#id_3-resolve-gene-symbols-hgnc_resolve_symbol"></a></h3>
<p>Resolve symbols, aliases, or previous symbols to current approved symbols:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Resolve current symbol (strict mode)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, mode <span class="op">=</span> <span class="st">"strict"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Approved Symbol:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">approved_symbol</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Confidence:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">confidence</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"HGNC ID:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">hgnc_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Resolve with lenient mode (searches aliases and previous symbols)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="st">"TP53"</span>, mode <span class="op">=</span> <span class="st">"lenient"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Approved Symbol:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">approved_symbol</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Match Type:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">confidence</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Case insensitive</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="st">"brca1"</span>, mode <span class="op">=</span> <span class="st">"strict"</span><span class="op">)</span></span>
<span><span class="co"># Returns "BRCA1"</span></span>
<span></span>
<span><span class="co"># Get full gene record</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="st">"EGFR"</span>, mode <span class="op">=</span> <span class="st">"lenient"</span>, return_record <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Location:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">record</span><span class="op">$</span><span class="va">location</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Chromosome:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">record</span><span class="op">$</span><span class="va">chromosome</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Handle not found</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="st">"NOTAREALGENE"</span>, mode <span class="op">=</span> <span class="st">"strict"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">confidence</span> <span class="op">==</span> <span class="st">"not_found"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gene not found\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_4-extract-cross-references-hgnc_xrefs">4. Extract Cross-References: <code>hgnc_xrefs()</code>
<a class="anchor" aria-label="anchor" href="#id_4-extract-cross-references-hgnc_xrefs"></a></h3>
<p>Get external database identifiers for dataset harmonization:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get cross-references by symbol</span></span>
<span><span class="va">xrefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_xrefs.html">hgnc_xrefs</a></span><span class="op">(</span><span class="st">"BRCA1"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"HGNC ID:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">hgnc_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Symbol:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">symbol</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Entrez ID:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">entrez_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Ensembl ID:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">ensembl_gene_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"UniProt:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">uniprot_ids</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"OMIM:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">omim_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"MANE Select:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">mane_select</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get cross-references by HGNC ID</span></span>
<span><span class="va">xrefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_xrefs.html">hgnc_xrefs</a></span><span class="op">(</span><span class="st">"HGNC:1100"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Batch processing example</span></span>
<span><span class="va">my_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"BRCA2"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span><span class="op">)</span></span>
<span><span class="va">xref_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">my_genes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_xrefs.html">hgnc_xrefs</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      symbol <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">symbol</span>,</span>
<span>      hgnc_id <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">hgnc_id</span>,</span>
<span>      entrez <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">entrez_id</span>,</span>
<span>      ensembl <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">ensembl_gene_id</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">xref_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">xref_table</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">xref_df</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="batch-operations-phase-13-1">Batch Operations (Phase 1.3)<a class="anchor" aria-label="anchor" href="#batch-operations-phase-13-1"></a></h2>
<p>For processing large lists of gene symbols efficiently using cached data.</p>
<div class="section level3">
<h3 id="id_5-build-symbol-index-build_symbol_index">5. Build Symbol Index: <code>build_symbol_index()</code>
<a class="anchor" aria-label="anchor" href="#id_5-build-symbol-index-build_symbol_index"></a></h3>
<p>Create a fast in-memory lookup index from cached HGNC data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build index from cached data (loads cache if needed)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_symbol_index.html">build_symbol_index</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The index contains multiple lookup tables:</span></span>
<span><span class="co"># - symbol_to_id: Direct symbol → HGNC ID mapping</span></span>
<span><span class="co"># - alias_to_id: Alias symbols → HGNC ID(s) mapping</span></span>
<span><span class="co"># - prev_to_id: Previous symbols → HGNC ID(s) mapping</span></span>
<span><span class="co"># - id_to_record: HGNC ID → full gene record mapping</span></span>
<span></span>
<span><span class="co"># Quick lookups</span></span>
<span><span class="va">hgnc_id</span> <span class="op">&lt;-</span> <span class="va">index</span><span class="op">$</span><span class="va">symbol_to_id</span><span class="op">[</span><span class="st">"BRCA1"</span><span class="op">]</span></span>
<span><span class="va">gene_record</span> <span class="op">&lt;-</span> <span class="va">index</span><span class="op">$</span><span class="va">id_to_record</span><span class="op">[[</span><span class="va">hgnc_id</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gene_record</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if a symbol has aliases</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"TP53"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">index</span><span class="op">$</span><span class="va">alias_to_id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">index</span><span class="op">$</span><span class="va">alias_to_id</span><span class="op">[[</span><span class="st">"TP53"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Build index from custom data (useful for testing)</span></span>
<span><span class="va">custom_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_hgnc_data.html">load_hgnc_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_symbol_index.html">build_symbol_index</a></span><span class="op">(</span><span class="va">custom_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_6-normalize-gene-lists-hgnc_normalize_list">6. Normalize Gene Lists: <code>hgnc_normalize_list()</code>
<a class="anchor" aria-label="anchor" href="#id_6-normalize-gene-lists-hgnc_normalize_list"></a></h3>
<p>Batch normalize and validate gene symbol lists:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic usage: normalize a list of symbols</span></span>
<span><span class="va">gene_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>, <span class="st">"MYC"</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">gene_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="co"># $total_input: 5</span></span>
<span><span class="co"># $found: 5</span></span>
<span><span class="co"># $not_found: 0</span></span>
<span><span class="co"># $withdrawn: 0</span></span>
<span><span class="co"># $duplicates_removed: 0</span></span>
<span></span>
<span><span class="co"># Access normalized results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#   symbol  name                    hgnc_id     status    query_symbol match_type</span></span>
<span><span class="co">#   BRCA1   BRCA1 DNA repair...     HGNC:1100  Approved  BRCA1        exact</span></span>
<span><span class="co">#   TP53    tumor protein p53       HGNC:11998 Approved  TP53         exact</span></span>
<span><span class="co">#   ...</span></span>
<span></span>
<span><span class="co"># Check warnings</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">warnings</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Warnings:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">warnings</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Handle not found symbols</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">not_found</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Not found:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">not_found</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Advanced Usage:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Handle mixed case and whitespace</span></span>
<span><span class="va">messy_symbols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">" brca1 "</span>, <span class="st">"Tp53"</span>, <span class="st">"EGFR"</span>, <span class="st">"  kras  "</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">messy_symbols</span><span class="op">)</span></span>
<span><span class="co"># All symbols normalized to uppercase and trimmed</span></span>
<span></span>
<span><span class="co"># Detect duplicates</span></span>
<span><span class="va">duplicated_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"BRCA2"</span>, <span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"BRCA1"</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">duplicated_list</span>, dedupe <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">duplicates_removed</span><span class="op">)</span>  <span class="co"># 2</span></span>
<span><span class="co"># Warnings will indicate which entries were duplicates</span></span>
<span></span>
<span><span class="co"># Include all statuses (even withdrawn genes)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">gene_list</span>, status <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co"># Check withdrawn genes</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">withdrawn</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">withdrawn</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Custom return fields</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span></span>
<span>  <span class="va">gene_list</span>,</span>
<span>  return_fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"name"</span>, <span class="st">"hgnc_id"</span>, <span class="st">"entrez_id"</span>, <span class="st">"location"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Return all available fields</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">gene_list</span>, return_fields <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reuse index for multiple batches (much faster)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_symbol_index.html">build_symbol_index</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">batch1_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">batch1</span>, index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span>
<span><span class="va">batch2_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">batch2</span>, index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span>
<span><span class="va">batch3_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">batch3</span>, index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span></code></pre></div>
<p><strong>Handling Problematic Symbols:</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mix of valid, invalid, and withdrawn symbols</span></span>
<span><span class="va">problem_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"BRCA1"</span>,           <span class="co"># valid</span></span>
<span>  <span class="st">"NOTAREALGENE"</span>,    <span class="co"># invalid</span></span>
<span>  <span class="st">"brca2"</span>,           <span class="co"># valid (case insensitive)</span></span>
<span>  <span class="st">""</span>,                <span class="co"># empty</span></span>
<span>  <span class="cn">NA</span>,                <span class="co"># missing</span></span>
<span>  <span class="st">"WITHDRAWN_GENE"</span>   <span class="co"># withdrawn (example)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">problem_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine each issue category</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Found:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">found</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Not found:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">not_found</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Withdrawn:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">withdrawn</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get detailed warnings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDetailed warnings:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">warnings</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List of symbols that couldn't be resolved</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">not_found</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Details about withdrawn genes</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">withdrawn</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">withdrawn</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"status"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Performance Comparison:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Batch operations using cached data (FAST)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span><span class="va">large_gene_list</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># ~1-2 seconds for 1000 symbols</span></span>
<span></span>
<span><span class="co"># vs. individual REST API calls (SLOW)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">large_gene_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">sym</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="va">sym</span>, mode <span class="op">=</span> <span class="st">"lenient"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># ~100+ seconds for 1000 symbols (rate limited)</span></span>
<span></span>
<span><span class="co"># For large lists, always use hgnc_normalize_list()!</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="complete-workflow-examples">Complete Workflow Examples<a class="anchor" aria-label="anchor" href="#complete-workflow-examples"></a></h2>
<div class="section level3">
<h3 id="example-1-search--resolve--get-cross-references">Example 1: Search → Resolve → Get Cross-References<a class="anchor" aria-label="anchor" href="#example-1-search--resolve--get-cross-references"></a></h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Search for genes</span></span>
<span><span class="va">search_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_find.html">hgnc_find</a></span><span class="op">(</span><span class="st">"breast cancer"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Resolve top result to ensure it's the current symbol</span></span>
<span><span class="va">top_symbol</span> <span class="op">&lt;-</span> <span class="va">search_results</span><span class="op">$</span><span class="va">docs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">symbol</span></span>
<span><span class="va">resolved</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="va">top_symbol</span>, mode <span class="op">=</span> <span class="st">"lenient"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Get cross-references for the approved symbol</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">resolved</span><span class="op">$</span><span class="va">confidence</span> <span class="op">!=</span> <span class="st">"not_found"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">xrefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_xrefs.html">hgnc_xrefs</a></span><span class="op">(</span><span class="va">resolved</span><span class="op">$</span><span class="va">approved_symbol</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mapping"</span>, <span class="va">resolved</span><span class="op">$</span><span class="va">query</span>, <span class="st">"to databases:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  NCBI Gene:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">entrez_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Ensembl:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">ensembl_gene_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-normalize-a-list-of-gene-symbols">Example 2: Normalize a List of Gene Symbols<a class="anchor" aria-label="anchor" href="#example-2-normalize-a-list-of-gene-symbols"></a></h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Input: mixed case, possibly outdated symbols</span></span>
<span><span class="va">gene_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"brca1"</span>, <span class="st">"tp53"</span>, <span class="st">"egfr"</span>, <span class="st">"KRAS"</span>, <span class="st">"her2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize each symbol</span></span>
<span><span class="va">normalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">gene_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="va">symbol</span>, mode <span class="op">=</span> <span class="st">"lenient"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    input <span class="op">=</span> <span class="va">symbol</span>,</span>
<span>    approved <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">approved_symbol</span>,</span>
<span>    confidence <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">confidence</span>,</span>
<span>    status <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">status</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to data frame</span></span>
<span><span class="va">norm_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">normalized</span>, <span class="va">as.data.frame</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">norm_df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3-id-conversion-for-dataset-harmonization">Example 3: ID Conversion for Dataset Harmonization<a class="anchor" aria-label="anchor" href="#example-3-id-conversion-for-dataset-harmonization"></a></h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert Entrez IDs to Ensembl IDs</span></span>
<span><span class="va">entrez_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"672"</span>, <span class="st">"7157"</span>, <span class="st">"1956"</span><span class="op">)</span>  <span class="co"># BRCA1, TP53, EGFR</span></span>
<span></span>
<span><span class="va">conversion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">entrez_ids</span>, <span class="kw">function</span><span class="op">(</span><span class="va">eid</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_fetch.html">hgnc_fetch</a></span><span class="op">(</span><span class="st">"entrez_id"</span>, <span class="va">eid</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">gene</span><span class="op">$</span><span class="va">numFound</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">doc</span> <span class="op">&lt;-</span> <span class="va">gene</span><span class="op">$</span><span class="va">docs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      entrez_id <span class="op">=</span> <span class="va">eid</span>,</span>
<span>      symbol <span class="op">=</span> <span class="va">doc</span><span class="op">$</span><span class="va">symbol</span>,</span>
<span>      ensembl_id <span class="op">=</span> <span class="va">doc</span><span class="op">$</span><span class="va">ensembl_gene_id</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="cn">NA</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">conversion_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">conversion</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">conversion_table</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-4-batch-normalize-clinical-gene-panel">Example 4: Batch Normalize Clinical Gene Panel<a class="anchor" aria-label="anchor" href="#example-4-batch-normalize-clinical-gene-panel"></a></h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scenario: Validate and normalize a clinical gene panel</span></span>
<span><span class="co"># Input may have mixed case, aliases, outdated symbols</span></span>
<span></span>
<span><span class="va">clinical_panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"BRCA1"</span>, <span class="st">"BRCA2"</span>,        <span class="co"># Hereditary breast cancer</span></span>
<span>  <span class="st">"tp53"</span>,                   <span class="co"># Mixed case</span></span>
<span>  <span class="st">"MLH1"</span>, <span class="st">"MSH2"</span>, <span class="st">"MSH6"</span>,  <span class="co"># Lynch syndrome</span></span>
<span>  <span class="st">"APC"</span>,                    <span class="co"># Familial adenomatous polyposis</span></span>
<span>  <span class="st">"RET"</span>,                    <span class="co"># MEN syndromes</span></span>
<span>  <span class="st">"BRCA1"</span>                   <span class="co"># Duplicate entry</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize the entire list at once</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span></span>
<span>  <span class="va">clinical_panel</span>,</span>
<span>  return_fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"name"</span>, <span class="st">"hgnc_id"</span>, <span class="st">"location"</span>, <span class="st">"status"</span><span class="op">)</span>,</span>
<span>  dedupe <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate QC report</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=== Gene Panel Validation Report ===\n\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total input symbols:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">total_input</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Valid genes found:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">found</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Not found:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">not_found</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Withdrawn genes:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">withdrawn</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Duplicates removed:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">duplicates_removed</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show match types</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">match_types</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Match types:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">match_types</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Display warnings</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">warnings</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Warnings:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"  -"</span>, <span class="va">result</span><span class="op">$</span><span class="va">warnings</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Final normalized panel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=== Normalized Gene Panel ===\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">results</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"name"</span>, <span class="st">"location"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export for downstream use</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">results</span>, <span class="st">"normalized_panel.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-5-large-scale-data-harmonization">Example 5: Large-Scale Data Harmonization<a class="anchor" aria-label="anchor" href="#example-5-large-scale-data-harmonization"></a></h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scenario: Harmonize gene symbols from multiple datasets</span></span>
<span><span class="co"># Each dataset may use different nomenclature (aliases, old symbols)</span></span>
<span></span>
<span><span class="co"># Simulate datasets with different symbol conventions</span></span>
<span><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span><span class="op">)</span></span>
<span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"brca1"</span>, <span class="st">"tp53"</span>, <span class="st">"her2"</span><span class="op">)</span>  <span class="co"># Mixed case, alias for ERBB2</span></span>
<span><span class="va">dataset3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"P53"</span>, <span class="st">"EGFR"</span><span class="op">)</span>   <span class="co"># P53 is old symbol for TP53</span></span>
<span></span>
<span><span class="co"># Build index once for efficiency</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_symbol_index.html">build_symbol_index</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize each dataset</span></span>
<span><span class="va">datasets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dataset1 <span class="op">=</span> <span class="va">dataset1</span>,</span>
<span>  dataset2 <span class="op">=</span> <span class="va">dataset2</span>,</span>
<span>  dataset3 <span class="op">=</span> <span class="va">dataset3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">harmonized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ds_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Processing"</span>, <span class="va">ds_name</span>, <span class="st">"...\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_normalize_list.html">hgnc_normalize_list</a></span><span class="op">(</span></span>
<span>    <span class="va">datasets</span><span class="op">[[</span><span class="va">ds_name</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    index <span class="op">=</span> <span class="va">index</span>,</span>
<span>    return_fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"hgnc_id"</span>, <span class="st">"entrez_id"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add dataset source</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">results</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">ds_name</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all harmonized data</span></span>
<span><span class="va">harmonized_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">harmonized</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create unified gene list (deduplicated by HGNC ID)</span></span>
<span><span class="va">unified</span> <span class="op">&lt;-</span> <span class="va">harmonized_df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">harmonized_df</span><span class="op">$</span><span class="va">hgnc_id</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Harmonization Summary ===\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total genes across datasets:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">harmonized_df</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Unique genes:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">unified</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unified</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
<p>Run the comprehensive test suite:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install testthat if needed</span></span>
<span><span class="co"># install.packages("testthat")</span></span>
<span></span>
<span><span class="co"># Run all tests</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_dir.html" class="external-link">test_dir</a></span><span class="op">(</span><span class="st">"tests/testthat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run specific test file</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_file.html" class="external-link">test_file</a></span><span class="op">(</span><span class="st">"tests/testthat/test-hgnc_tools.R"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rate-limiting">Rate Limiting<a class="anchor" aria-label="anchor" href="#rate-limiting"></a></h2>
<p>All functions automatically respect HGNC’s rate limit of 10 requests per second:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The rate limiter works automatically</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_find.html">hgnc_find</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Automatically throttled to ≤10 req/sec</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Reset rate limiter (mainly for testing)</span></span>
<span><span class="fu"><a href="reference/reset_rate_limiter.html">reset_rate_limiter</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a></h2>
<p>The <code><a href="reference/hgnc_rest_info.html">hgnc_rest_info()</a></code> function is cached for the session:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First call hits API</span></span>
<span><span class="va">info1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_rest_info.html">hgnc_rest_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Second call uses cache (instant)</span></span>
<span><span class="va">info2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_rest_info.html">hgnc_rest_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clear cache to force fresh API call</span></span>
<span><span class="fu"><a href="reference/clear_hgnc_cache.html">clear_hgnc_cache</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Next call will hit API again</span></span>
<span><span class="va">info3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_rest_info.html">hgnc_rest_info</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="error-handling">Error Handling<a class="anchor" aria-label="anchor" href="#error-handling"></a></h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Handle not found</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="st">"INVALIDGENE"</span>, mode <span class="op">=</span> <span class="st">"strict"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">approved_symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gene not found\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Handle missing cross-references</span></span>
<span><span class="va">xrefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_xrefs.html">hgnc_xrefs</a></span><span class="op">(</span><span class="st">"BRCA1"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">xrefs</span><span class="op">$</span><span class="va">omim_id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"OMIM ID:"</span>, <span class="va">xrefs</span><span class="op">$</span><span class="va">omim_id</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No OMIM ID available\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Handle withdrawn genes</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_resolve_symbol.html">hgnc_resolve_symbol</a></span><span class="op">(</span><span class="st">"SOMEGENE"</span>, mode <span class="op">=</span> <span class="st">"lenient"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="st">"Withdrawn"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Warning: This gene has been withdrawn\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="change-tracking--validation-phase-15">Change Tracking &amp; Validation (Phase 1.5)<a class="anchor" aria-label="anchor" href="#change-tracking--validation-phase-15"></a></h2>
<p>Functions for monitoring gene nomenclature changes and validating gene lists against HGNC policies.</p>
<div class="section level3">
<h3 id="id_7-track-gene-changes-hgnc_changes">7. Track Gene Changes: <code>hgnc_changes()</code>
<a class="anchor" aria-label="anchor" href="#id_7-track-gene-changes-hgnc_changes"></a></h3>
<p>Monitor genes that have been modified since a specific date:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find all genes modified in the last 30 days</span></span>
<span><span class="va">recent_changes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_changes.html">hgnc_changes</a></span><span class="op">(</span>since <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">recent_changes</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="co"># $total: number of changed genes</span></span>
<span><span class="co"># $since: the date used for filtering</span></span>
<span><span class="co"># $change_type: type of changes tracked</span></span>
<span><span class="co"># $symbol_changes: count of symbol changes</span></span>
<span><span class="co"># $name_changes: count of name changes</span></span>
<span></span>
<span><span class="co"># View changed genes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">recent_changes</span><span class="op">$</span><span class="va">changes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find symbol changes since a specific date</span></span>
<span><span class="va">symbol_changes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_changes.html">hgnc_changes</a></span><span class="op">(</span></span>
<span>  since <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  change_type <span class="op">=</span> <span class="st">"symbol"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># See which genes had their symbols changed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">symbol_changes</span><span class="op">$</span><span class="va">changes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Genes with symbol changes:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">symbol_changes</span><span class="op">$</span><span class="va">changes</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"prev_symbol"</span>, <span class="st">"date_symbol_changed"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Track name changes with detailed information</span></span>
<span><span class="va">name_changes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_changes.html">hgnc_changes</a></span><span class="op">(</span></span>
<span>  since <span class="op">=</span> <span class="st">"2023-06-01"</span>,</span>
<span>  change_type <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"name"</span>, <span class="st">"status"</span>, <span class="st">"date_name_changed"</span>, <span class="st">"date_modified"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All changes (any modification)</span></span>
<span><span class="va">all_changes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_changes.html">hgnc_changes</a></span><span class="op">(</span></span>
<span>  since <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  change_type <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">all_changes</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<p><strong>Use Cases:</strong> - Monitor watchlists for nomenclature updates - Ensure compliance with current nomenclature - Track when genes in your panel were last updated - Identify genes that need review in your datasets</p>
</div>
<div class="section level3">
<h3 id="id_8-validate-gene-panels-hgnc_validate_panel">8. Validate Gene Panels: <code>hgnc_validate_panel()</code>
<a class="anchor" aria-label="anchor" href="#id_8-validate-gene-panels-hgnc_validate_panel"></a></h3>
<p>Comprehensive quality assurance for gene lists:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic validation</span></span>
<span><span class="va">gene_panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>, <span class="st">"MYC"</span><span class="op">)</span></span>
<span><span class="va">validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_validate_panel.html">hgnc_validate_panel</a></span><span class="op">(</span><span class="va">gene_panel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View summary statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="co"># $total_items: total input</span></span>
<span><span class="co"># $valid: approved symbols</span></span>
<span><span class="co"># $issues: problems found</span></span>
<span><span class="co"># $issues_by_type: breakdown by issue type</span></span>
<span><span class="co"># $issues_by_severity: errors vs warnings</span></span>
<span></span>
<span><span class="co"># View human-readable report</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">report</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check valid genes</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">valid</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">valid</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"name"</span>, <span class="st">"hgnc_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Check issues</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">issues</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">issues</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"position"</span>, <span class="st">"input"</span>, <span class="st">"issue"</span>, <span class="st">"message"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Get replacement suggestions</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">replacements</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">repl</span> <span class="kw">in</span> <span class="va">validation</span><span class="op">$</span><span class="va">replacements</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Position %d: '%s' → '%s' (%s)\n"</span>,</span>
<span>                <span class="va">repl</span><span class="op">$</span><span class="va">position</span>, <span class="va">repl</span><span class="op">$</span><span class="va">input</span>,</span>
<span>                <span class="va">repl</span><span class="op">$</span><span class="va">suggested</span>, <span class="va">repl</span><span class="op">$</span><span class="va">rationale</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Validate Clinical Gene Panel with Mixed Quality:</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Real-world scenario: mixed case, duplicates, old symbols, invalid entries</span></span>
<span><span class="va">clinical_panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"BRCA1"</span>,           <span class="co"># Valid approved symbol</span></span>
<span>  <span class="st">"brca2"</span>,           <span class="co"># Valid (case insensitive)</span></span>
<span>  <span class="st">"TP53"</span>,            <span class="co"># Valid</span></span>
<span>  <span class="st">"BRCA1"</span>,           <span class="co"># Duplicate</span></span>
<span>  <span class="st">"P53"</span>,             <span class="co"># Previous symbol for TP53 (if applicable)</span></span>
<span>  <span class="st">"HER2"</span>,            <span class="co"># Alias for ERBB2 (if applicable)</span></span>
<span>  <span class="st">"NOTAREALGENE"</span>,    <span class="co"># Invalid</span></span>
<span>  <span class="st">""</span>,                <span class="co"># Empty</span></span>
<span>  <span class="st">"MLH1"</span>,            <span class="co"># Valid</span></span>
<span>  <span class="st">"MSH2"</span>             <span class="co"># Valid</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_validate_panel.html">hgnc_validate_panel</a></span><span class="op">(</span></span>
<span>  <span class="va">clinical_panel</span>,</span>
<span>  suggest_replacements <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_dates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate QC report</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Gene Panel Validation Report ===\n\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">report</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Issues breakdown</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"issues_by_type"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nIssues by type:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">issues_by_type</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Detailed issue listing</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">issues</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nDetailed issues:\n"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">issues</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">issue</span> <span class="op">&lt;-</span> <span class="va">validation</span><span class="op">$</span><span class="va">issues</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"[%s] Position %d (%s): %s\n"</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">issue</span><span class="op">$</span><span class="va">severity</span><span class="op">)</span>,</span>
<span>                <span class="va">issue</span><span class="op">$</span><span class="va">position</span>,</span>
<span>                <span class="va">issue</span><span class="op">$</span><span class="va">input</span>,</span>
<span>                <span class="va">issue</span><span class="op">$</span><span class="va">message</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Suggested fixes</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">replacements</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nSuggested replacements:\n"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">repl</span> <span class="kw">in</span> <span class="va">validation</span><span class="op">$</span><span class="va">replacements</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">repl</span><span class="op">$</span><span class="va">suggested</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  '%s' → '%s'\n    Reason: %s\n"</span>,</span>
<span>                  <span class="va">repl</span><span class="op">$</span><span class="va">input</span>, <span class="va">repl</span><span class="op">$</span><span class="va">suggested</span>, <span class="va">repl</span><span class="op">$</span><span class="va">rationale</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Export clean panel (only valid genes)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">valid</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">valid</span>, <span class="st">"validated_panel.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nClean panel exported to validated_panel.csv\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Common Validation Issues Detected:</strong></p>
<ol style="list-style-type: decimal"><li>
<strong>Alias Used</strong>: Using an alias instead of the approved symbol</li>
<li>
<strong>Previous Symbol</strong>: Using an outdated symbol (gene was renamed)</li>
<li>
<strong>Withdrawn</strong>: Gene has been withdrawn from HGNC</li>
<li>
<strong>Duplicate</strong>: Same gene listed multiple times</li>
<li>
<strong>Not Found</strong>: Symbol doesn’t exist in HGNC database</li>
<li>
<strong>Empty/NA</strong>: Missing or empty values</li>
<li>
<strong>Ambiguous</strong>: Symbol matches multiple genes</li>
</ol><p><strong>Performance Optimization with Pre-built Index:</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build index once for validating multiple panels</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_symbol_index.html">build_symbol_index</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Validate multiple panels efficiently</span></span>
<span><span class="va">panel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"BRCA2"</span>, <span class="st">"TP53"</span><span class="op">)</span></span>
<span><span class="va">panel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MLH1"</span>, <span class="st">"MSH2"</span>, <span class="st">"MSH6"</span><span class="op">)</span></span>
<span><span class="va">panel3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"APC"</span>, <span class="st">"KRAS"</span>, <span class="st">"NRAS"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_validate_panel.html">hgnc_validate_panel</a></span><span class="op">(</span><span class="va">panel1</span>, index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_validate_panel.html">hgnc_validate_panel</a></span><span class="op">(</span><span class="va">panel2</span>, index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span>
<span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_validate_panel.html">hgnc_validate_panel</a></span><span class="op">(</span><span class="va">panel3</span>, index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Much faster than building index each time!</span></span></code></pre></div>
<p><strong>Integration with Change Tracking:</strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Workflow: Validate panel, then check when genes were last modified</span></span>
<span></span>
<span><span class="co"># 1. Validate your panel</span></span>
<span><span class="va">panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>, <span class="st">"APC"</span><span class="op">)</span></span>
<span><span class="va">validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_validate_panel.html">hgnc_validate_panel</a></span><span class="op">(</span><span class="va">panel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Extract valid genes</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">validation</span><span class="op">$</span><span class="va">valid</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">valid_symbols</span> <span class="op">&lt;-</span> <span class="va">validation</span><span class="op">$</span><span class="va">valid</span><span class="op">$</span><span class="va">symbol</span></span>
<span></span>
<span>  <span class="co"># 3. Check when these genes were last modified</span></span>
<span>  <span class="co"># Get the HGNC data with dates</span></span>
<span>  <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_symbol_index.html">build_symbol_index</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">sym</span> <span class="kw">in</span> <span class="va">valid_symbols</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">hgnc_id</span> <span class="op">&lt;-</span> <span class="va">index</span><span class="op">$</span><span class="va">symbol_to_id</span><span class="op">[</span><span class="va">sym</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">hgnc_id</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">hgnc_id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">gene</span> <span class="op">&lt;-</span> <span class="va">index</span><span class="op">$</span><span class="va">id_to_record</span><span class="op">[[</span><span class="va">hgnc_id</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s (HGNC:%s):\n"</span>, <span class="va">sym</span>, <span class="va">hgnc_id</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">gene</span><span class="op">$</span><span class="va">date_modified</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gene</span><span class="op">$</span><span class="va">date_modified</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Last modified: %s\n"</span>, <span class="va">gene</span><span class="op">$</span><span class="va">date_modified</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">gene</span><span class="op">$</span><span class="va">date_symbol_changed</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gene</span><span class="op">$</span><span class="va">date_symbol_changed</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Symbol changed: %s\n"</span>, <span class="va">gene</span><span class="op">$</span><span class="va">date_symbol_changed</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># 4. Or use hgnc_changes() to monitor these specific genes</span></span>
<span><span class="co"># (by filtering the results to your panel)</span></span>
<span><span class="va">recent_changes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hgnc_changes.html">hgnc_changes</a></span><span class="op">(</span>since <span class="op">=</span> <span class="st">"2024-01-01"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">recent_changes</span><span class="op">$</span><span class="va">changes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">panel_changes</span> <span class="op">&lt;-</span> <span class="va">recent_changes</span><span class="op">$</span><span class="va">changes</span><span class="op">[</span></span>
<span>    <span class="va">recent_changes</span><span class="op">$</span><span class="va">changes</span><span class="op">$</span><span class="va">symbol</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">valid_symbols</span>,</span>
<span>  <span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">panel_changes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nGenes in your panel that changed since 2024-01-01:\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">panel_changes</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symbol"</span>, <span class="st">"name"</span>, <span class="st">"date_modified"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a></h2>
<p>The core lookup tools (Phase 1.2), batch operations (Phase 1.3), groups &amp; collections (Phase 1.4), and change tracking &amp; validation (Phase 1.5) are now complete. Next phases include:</p>
<ul><li>
<strong>Phase 2</strong>: MCP server implementation</li>
<li>
<strong>Phase 3</strong>: Enhanced features</li>
<li>
<strong>Phase 4</strong>: Polish &amp; distribution</li>
</ul><p>See <code>TODO.md</code> for the complete implementation roadmap.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>hgnc.mcp is developed by <a href="https://aksoy.org" class="external-link">Bulent Arman Aksoy</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>. HGNC data from <a href="https://www.genenames.org/" class="external-link">genenames.org</a>.</p>
</div>

    </footer></div>





  </body></html>

